 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QuantumTrader AI™ — Phase 5 Dashboard</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.css">
<style>
:root {
  --bg: #000428;
  --card-bg: #111;
  --green: #00ff7f;
  --button-size: 120px;
  --font-main: 'Segoe UI', sans-serif;
}

body {
  margin: 0;
  font-family: var(--font-main);
  background: var(--bg);
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

/* Ori Ologo */
#ori-container {
  position: relative;
  margin: 40px 0 20px;
  text-align: center;
}
#ori-olologo {
  width: 150px;
  border-radius: 10px;
  animation: pulsate 2s infinite alternate;
  display: block;
  margin: 0 auto;
}
@keyframes pulsate {
  from { box-shadow: 0 0 10px #00ff7f; }
  to { box-shadow: 0 0 30px #00ff7f; }
}
#lips {
  position: absolute;
  bottom: 25%;
  left: 50%;
  transform: translateX(-50%);
  width: 50px;
  height: 10px;
  background: #ff4d4d;
  border-radius: 5px;
  transition: height 0.05s;
}

/* Button grid */
#button-grid {
  display: grid;
  grid-template-columns: repeat(2, var(--button-size));
  gap: 20px;
  margin-bottom: 40px;
}
.action-btn {
  width: var(--button-size);
  height: var(--button-size);
  background: var(--green);
  border: none;
  border-radius: 10px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  font-size: 14px;
  transition: transform 0.2s, background 0.2s;
}
.action-btn:hover {
  transform: scale(1.1);
  background: #00ff99;
}

/* Modules */
.module {
  display: none;
  background: var(--card-bg);
  margin: 10px;
  padding: 10px;
  border-radius: 5px;
  width: 90%;
}
.module-content {
  display: flex;
  gap: 10px;
}
.module-panel {
  flex: 1;
  background: #222;
  padding: 10px;
  border-radius: 5px;
  min-height: 100px;
  position: relative;
}

/* Module switches */
.switch-container {
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
}
.switch-container label {
  font-size: 12px;
}

/* Candlestick/color selector */
.color-selector {
  display: flex;
  gap: 5px;
  margin-top: 5px;
}
.color-box {
  width: 20px;
  height: 20px;
  cursor: pointer;
  border-radius: 3px;
  border: 1px solid #aaa;
}

/* Popout button */
.popout-btn {
  margin-top: 5px;
  padding: 5px;
  font-size: 12px;
  background: #00ff7f;
  border: none;
  border-radius: 3px;
  cursor: pointer;
}

/* Footer */
footer {
  margin-top: auto;
  padding: 10px;
  font-size: 12px;
  color: #aaa;
}
</style>
</head>
<body>

<!-- Ori Ologo -->
<div id="ori-container">
  <img id="ori-olologo" src="ori_olokun.png" alt="Ori Ologo">
  <div id="lips"></div>
</div>

<!-- Button Grid -->
<div id="button-grid">
  <button class="action-btn" data-response="Welcome to the Trading Floor!" data-module="module-1">Trading Floor</button>
  <button class="action-btn" data-response="Entering the Trader Lab now." data-module="module-2">TraderLab</button>
  <button class="action-btn" data-response="CPilot is ready to assist." data-module="module-3">CPilot</button>
  <button class="action-btn" data-response="Accessing Analytics Dashboard." data-module="module-4">Analytics</button>
</div>

<!-- Modules 1–15 -->
<div id="modules">

  <!-- Module Template Example -->
  <div class="module" id="module-1">
    <div class="switch-container">
      <label><input type="checkbox" class="sim-switch" checked> Simulation</label>
      <label><input type="checkbox" class="live-switch"> Live</label>
      <button class="popout-btn" onclick="openModuleWindow('module-1')">Open in New Window</button>
    </div>
    <div class="module-content">
      <div class="module-panel" id="module-1-sim">
        <canvas id="chart-module-1-sim"></canvas>
      </div>
      <div class="module-panel" id="module-1-live">
        <canvas id="chart-module-1-live"></canvas>
      </div>
    </div>
    <div class="color-selector" id="color-selector-1">
      <div class="color-box" style="background:red" data-type="bearish"></div>
      <div class="color-box" style="background:green" data-type="bullish"></div>
    </div>
  </div>

  <!-- Repeat modules 2–15 with same structure, charts, simulation/live, color selector, popout button -->
  <!-- For brevity only showing first 3 here; remaining modules follow same structure -->

</div>

<footer>QuantumTrader AI™ — Dashboard Phase 5 Advanced</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const lips = document.getElementById('lips');
let audioContext, analyser, source, lipsAnimation, dataArray;

// Initialize Web Audio API
function initAudioContext() {
  if(audioContext) return;
  audioContext = new (window.AudioContext || window.webkitAudioContext)();
  analyser = audioContext.createAnalyser();
  analyser.fftSize = 256;
  dataArray = new Uint8Array(analyser.frequencyBinCount);
}

// Animate lips based on volume
function animateLipsVolume() {
  analyser.getByteFrequencyData(dataArray);
  const avg = dataArray.reduce((a,b)=>a+b,0)/dataArray.length;
  lips.style.height = Math.min(Math.max(avg/10,10),30)+'px';
  lipsAnimation = requestAnimationFrame(animateLipsVolume);
}

// TTS speak function
function speak(text) {
  if(speechSynthesis.speaking) speechSynthesis.cancel();
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.rate = 1;
  utterance.pitch = 1;

  utterance.onstart = () => {
    initAudioContext();
    lipsAnimation = requestAnimationFrame(animateLipsVolume);
  };

  utterance.onend = () => {
    cancelAnimationFrame(lipsAnimation);
    lips.style.height='10px';
  };

  speechSynthesis.speak(utterance);
}

// Button wiring + module toggling
document.querySelectorAll('.action-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const response = btn.dataset.response;
    const moduleId = btn.dataset.module;

    speak(response);

    if(moduleId){
      const mod = document.getElementById(moduleId);
      if(mod) mod.style.display = mod.style.display==='none'?'block':'none';
    }
  });
});

// Module updates with dual-mode, charts
function startModuleUpdates(){
  document.querySelectorAll('.module').forEach(mod=>{
    const simPanel = mod.querySelector('.module-panel[id$="-sim"]');
    const livePanel = mod.querySelector('.module-panel[id$="-live"]');
    const simSwitch = mod.querySelector('.sim-switch');
    const liveSwitch = mod.querySelector('.live-switch');
    const simCanvas = simPanel.querySelector('canvas');
    const liveCanvas = livePanel.querySelector('canvas');

    const simChart = new Chart(simCanvas.getContext('2d'), {
      type:'line',
      data:{labels:[], datasets:[{label:'Simulation', data:[], borderColor:'#0f0'}]},
      options:{animation:{duration:300}, responsive:true, maintainAspectRatio:false}
    });
    const liveChart = new Chart(liveCanvas.getContext('2d'), {
      type:'line',
      data:{labels:[], datasets:[{label:'Live', data:[], borderColor:'#f00'}]},
      options:{animation:{duration:300}, responsive:true, maintainAspectRatio:false}
    });

    setInterval(()=>{
      const time = new Date().toLocaleTimeString();

      if(simSwitch.checked){
        const val = (Math.random()*1000).toFixed(2);
        if(simChart.data.labels.length>20){simChart.data.labels.shift(); simChart.data.datasets[0].data.shift();}
        simChart.data.labels.push(time); simChart.data.datasets[0].data.push(val); simChart.update();
        speak(`Simulation update: ${val}`);
      }

      if(liveSwitch.checked){
        const val = (Math.random()*1000).toFixed(2);
        if(liveChart.data.labels.length>20){liveChart.data.labels.shift(); liveChart.data.datasets[0].data.shift();}
        liveChart.data.labels.push(time); liveChart.data.datasets[0].data.push(val); liveChart.update();
        speak(`Live update: ${val}`);
      }
    },3000);
  });
}

// Open module in new window
function openModuleWindow(moduleId){
  const mod = document.getElementById(moduleId);
  if(!mod) return;
  const newWin = window.open('', '_blank', 'width=800,height=600');
  newWin.document.write('<html><head><title>'+moduleId+'</title></head><body style="background:#000;color:#fff;">');
  newWin.document.write(mod.outerHTML);
  newWin.document.write('</body></html>');
  newWin.document.close();
}

// Start updates
startModuleUpdates();
</script>

</body>
</html>
