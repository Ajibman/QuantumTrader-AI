 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QuantumTrader AIâ„¢</title>

  <!-- Core Styles -->
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="manifest" href="manifest.json" />

  <style>
    :root {
      --bg:#000428; --card:#071226; --muted:#bbb; --accent:#1abc9c;
      --buy:#2ecc71; --sell:#e74c3c; --hold:#f39c12;
      --panel-gap:12px; --header-gap:18px;
    }

    body{
      margin:0; padding:0;
      font-family:Inter, Arial, sans-serif;
      color:#fff;
      background:var(--bg);
    }

    .container{max-width:1120px; margin:0 auto; padding:18px;}
    header{display:flex; justify-content:center; align-items:center; gap:var(--header-gap); flex-wrap:wrap;}
    header img{max-height:80px; height:auto; display:block;}

    h1{text-align:center; font-size:24px;}
    h2{text-align:center; font-size:18px; color:var(--muted); margin-bottom:24px;}
    .status{text-align:center; margin-bottom:16px; font-size:14px; color:var(--muted);}
    .modules{display:flex; flex-wrap:wrap; gap:16px; justify-content:center;}
    .module-btn{
      background:var(--accent); color:#061018; padding:16px 24px;
      border:none; border-radius:8px; cursor:pointer;
      font-weight:700; flex:0 1 120px; text-align:center;
      transition:transform .12s ease;
    }
    .module-btn:hover{transform:translateY(-3px);}

    /* =========================
       IMAGE PROPORTIONALITY & GLOW
    ========================== */
    .globe { max-width: 35vw; min-width: 200px; height:auto; display:block; margin:24px auto; }

    /* Ori Olokun Ring */
    .ori-ring {
      width: 260px; max-width:25vw; min-width:180px;
      height:260px; max-height:25vw; min-height:180px;
      margin: 24px auto; border: 4px solid #1abc9c;
      border-radius:50%; display:flex; justify-content:center; align-items:center;
      box-shadow:0 0 20px rgba(26,188,156,0.5);
      animation: ringGlow 3s ease-in-out infinite;
    }
    .ori-ring .feature-image{
      width:70%; height:auto; border-radius:50%; animation: pulse 1.8s infinite;
    }
    .ori-name{
      text-align:center; font-size:1.2rem; color:#1abc9c;
      font-weight:700; margin-top:8px;
      text-shadow:0 0 6px rgba(26,188,156,0.7);
    }

    /* Map */
    #macarthur-map { max-width: 60vw; min-width:300px; height:auto; display:block; margin:16px auto; border-radius:8px; }

    /* Animations */
    @keyframes pulse {
      0%,100%{ transform: scale(1); opacity:1; }
      50%{ transform: scale(1.03); opacity:0.85; }
    }
    @keyframes ringGlow {
      0%,100%{ box-shadow:0 0 20px rgba(26,188,156,0.5); }
      50%{ box-shadow:0 0 32px rgba(26,188,156,0.8); }
    }

    /* Responsive */
    @media(max-width:880px){ .ori-ring{max-width:50vw; max-height:50vw;} .ori-name{font-size:1rem;} }
    @media(max-width:520px){ .ori-ring{max-width:70vw; max-height:70vw;} .ori-name{font-size:0.9rem;} }

    /* Dashboard dormant */
    #dashboard-mode{display:none;}
    #dashboard-mode.active{display:block;}
    #home-mode.active{display:block;}
    #home-mode{display:block;}

    /* Node sections & cards */
    .node-section{margin-top:22px; padding:10px;}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
      border-radius:10px; padding:14px;
      box-shadow:0 6px 18px rgba(0,0,0,0.45);
    }
    .center{text-align:center;}
    button.cta{
      background:var(--accent); color:#061018; border:none;
      padding:12px 20px; border-radius:8px; cursor:pointer; font-weight:700;
    }
    #currencies-panel{display:grid; grid-template-columns:repeat(2,1fr); gap:var(--panel-gap);}
    footer{margin-top:28px; padding:14px; text-align:center; color:var(--muted); font-size:13px;}
  </style>

 <body>
  
 <!-- HEADER / STATUS -->
  <header id="qt-header">
    <!-- logo, clock, status lights -->
  </header>

  <!-- MAIN DASHBOARD -->
  <main id="qt-dashboard">

    <!-- ðŸ‘‡ BUTTONS GO HERE -->
    <section id="qt-controls">
      <button data-action="ENTER_DASHBOARD">Enter Dashboard</button>
      <button data-action="START_SIMULATION">Start Simulation</button>
    </section>

    <!-- charts, panels, visuals -->
  </main>

  <!-- FOOTER / Ori Olokun -->
  <footer id="qt-footer">
    <!-- Ori Olokun image -->
  </footer>

  <!-- scripts load AFTER all UI -->
  <script src="js/core/state.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      QTState.init();
      QTState.bindUI();
    });
  </script>

 </body>
  <div class="container">
    <!-- Header -->
    <header>
      <img src="assets/images/peace_index_logo.png" class="logo" alt="Peace Index Logo">
    </header>

    <!-- =========================
         Home / Landing Mode
    ========================== -->
    <main id="home-mode" class="active">
      <!-- Globe -->
      <section id="globe-section">
        <img src="assets/images/qtai_globe.png" class="globe" alt="QuantumTrader Globe">
      </section>

      <!-- Ori Olokun Ring -->
      <section id="ori-olokun">
        <div class="ori-ring">
          <img src="assets/images/qtai_ori_olokun.png" class="feature-image" alt="Ori Olokun â€” QuantumTrader AI">
        </div>
        <div class="ori-name">Ori Ologo</div>
      </section>

      <h1>Welcome to QuantumTrader AIâ„¢</h1>
      <h2>Activate modules after training completion and payment</h2>
      <div id="activationStatus" class="status">Checking activation & payment status...</div>

      <div class="modules">
        <button id="tradingFloorBtn" class="module-btn">Trading Floor</button>
        <button id="traderLabBtn" class="module-btn">TraderLabâ„¢</button>
        <button id="cpilotBtn" class="module-btn">CPilotâ„¢</button>
        <button id="paymentBtn" class="module-btn">Payment Gate</button>
      </div>
    </main>

    <!-- =========================
         Dashboard Mode (Dormant)
    ========================== -->
    <main id="dashboard-mode">
      <!-- MAP -->
      <section class="node-section">
        <div class="card center">
          <img id="macarthur-map" src="assets/images/macarthur.png" alt="MacArthur Map">
        </div>
      </section>

      <!-- Payments -->
      <section class="node-section">
        <div class="card">
          <h2>Payments</h2>
          <select id="paymentOption">
            <option value="OPTION_1">Option 1</option>
            <option value="OPTION_2">Option 2</option>
            <option value="OPTION_3">Option 3</option>
          </select>
          <button id="payBtn" class="cta">Pay Now</button>
        </div>
      </section>

      <!-- Currencies -->
      <section class="node-section">
        <div class="card">
          <h2>Top 10 Currencies â€” Market Engine</h2>
          <div id="currencies-panel"></div>
        </div>
      </section>

      <!-- Logs -->
      <section class="node-section">
        <div class="card">
          <h2>Trade & System Logs</h2>
          <div id="logs-panel"><p class="muted">No logs yetâ€¦</p></div>
        </div>
      </section>
    </main>

    <footer>
      Â© 2025 QuantumTrader AIâ„¢ | Olagoke Ajibulu â€” Architect, Concepts & Design
    </footer>
  </div>

  <!-- =========================
       App JS + Proportionality Preview
  ========================== -->
  <script type="module">
    import { state } from './assets/js/core/state.js';
    import { handlePaymentRequest } from './assets/js/core/payment.js';
    import { runOption1Payment } from './utils/option1-trigger.js';
    import { runOption2Payment } from './utils/option2-trigger.js';
    import { runOption3Payment } from './utils/option3-trigger.js';

    const activationStatus = document.getElementById('activationStatus');
    const tradingFloorBtn = document.getElementById('tradingFloorBtn');
    const traderLabBtn = document.getElementById('traderLabBtn');
    const cpilotBtn = document.getElementById('cpilotBtn');
    const paymentBtn = document.getElementById('paymentBtn');
    const homeMode = document.getElementById('home-mode');
    const dashboardMode = document.getElementById('dashboard-mode');
    const payBtn = document.getElementById('payBtn');
    const paymentOption = document.getElementById('paymentOption');

    function enterDashboard() {
      homeMode.classList.remove('active');
      dashboardMode.classList.add('active');
    }

    /* ===============================
       Module Navigation
    =============================== */
    tradingFloorBtn.addEventListener('click', () => {
      if (!state.trainingCompleted || state.paymentLayer !== 'LIVE') {
        alert('Complete training and payment to access Trading Floor.');
        return;
      }
      enterDashboard();
    });

    traderLabBtn.addEventListener('click', () => {
      if (!state.trainingCompleted) {
        alert('Complete training to access TraderLabâ„¢.');
        return;
      }
      window.location.href = 'traderlab.html';
    });

    cpilotBtn.addEventListener('click', () => {
      window.location.href = 'cpilot.html';
    });

    /* ===============================
       Payment Gates
    =============================== */
    paymentBtn.addEventListener('click', () => {
      const method = prompt('Enter payment method (CARD/TRANSFER):', 'CARD');
      const amount = parseFloat(prompt('Enter amount in NGN:', '10000'));
      handlePaymentRequest(method, amount);
      updateActivationStatus();
    });

    payBtn.addEventListener('click', async () => {
      payBtn.disabled = true;
      payBtn.textContent = 'Processingâ€¦';
      const currentUser = { id:'USER123' };
      const paymentData = { amount:2000, method:'CARD' };
      let result;
      switch(paymentOption.value){
        case 'OPTION_1': result = await runOption1Payment(currentUser,paymentData); break;
        case 'OPTION_2': result = await runOption2Payment(currentUser,paymentData); break;
        case 'OPTION_3': result = await runOption3Payment(currentUser,paymentData); break;
      }
      if(result?.status==='BLOCKED') alert(result.reason);
      else if(result?.status==='SUCCESS') alert('Payment processed.');
      else alert('Payment failed.');
      payBtn.disabled = false;
      payBtn.textContent = 'Pay Now';
    });

    function updateActivationStatus() {
      const msg = [];
      msg.push(state.trainingCompleted ? 'Training âœ…' : 'Training âŒ');
      msg.push(state.paymentLayer==='LIVE' ? 'Payment âœ…' : 'Payment âŒ');
      activationStatus.textContent = msg.join(' | ');
    }
    updateActivationStatus();

    /* ===============================
       FULL DASHBOARD PROPORTIONALITY PREVIEW
    =============================== */
    (function(){
      const previewElements = [
        { el: document.querySelector('.globe'), name: 'Globe' },
        { el: document.querySelector('#ori-olokun .feature-image'), name: 'Ori Ologo' },
        { el: document.querySelector('#macarthur-map'), name: 'MacArthur Map' },
        { el: document.getElementById('tradingFloorBtn'), name: 'Trading Floor Btn' },
        { el: document.getElementById('traderLabBtn'), name: 'TraderLab Btn' },
        { el: document.getElementById('cpilotBtn'), name: 'CPilot Btn' },
        { el: document.getElementById('paymentBtn'), name: 'Payment Btn' }
      ];
      previewElements.forEach(item=>{
        if(!item.el) return;
        const overlay=document.createElement('div');
        overlay.style.position='absolute';
        overlay.style.background='rgba(26,188,156,0.3)';
        overlay.style.color='#000';
        overlay.style.fontSize='12px';
        overlay.style.fontWeight='700';
        overlay.style.padding='2px 6px';
        overlay.style.borderRadius='4px';
        overlay.style.top='0'; overlay.style.left='0';
        overlay.style.zIndex='9999';
        overlay.style.pointerEvents='none';
        overlay.textContent='';
        const parent=item.el.parentElement;
        if(getComputedStyle(parent).position==='static') parent.style.position='relative';
        parent.appendChild(overlay);
        function updateSize(){
          const rect=item.el.getBoundingClientRect();
          overlay.textContent=`${item.name}: ${Math.round(rect.width)}px Ã— ${Math.round(rect.height)}px`;
        }
        updateSize();
        window.addEventListener('resize',updateSize);
      });
      console.log('%cFull Dashboard Proportionality Preview Enabled','color:#1abc9c; font-weight:700;');
    })();
   
  </script>
 
<!-- CORE STATE (authoritative) -->
<script src="js/core/state.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM ready');

    if (!window.QTState) {
      console.error('QTState not found');
      return;
    }

    QTState.init();      // wake state machine ONCE
    QTState.bindUI();    // bind buttons ONCE

    console.log('UI bound');
  });
</script>

<script>
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.module-btn');
  if (!btn) return;

  // OBSERVATION ONLY
  console.log('[Observer]', btn.id, {
    trainingCompleted: window.state?.trainingCompleted,
    paymentLayer: window.state?.paymentLayer
  });

  // Optional visual confirmation (non-invasive)
  btn.style.outline = '2px solid #1abc9c';
  setTimeout(() => btn.style.outline = '', 300);
});
</script>

<!-- SAFE CLICK OBSERVER (Mentor-approved) -->
<script>
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.module-btn');
  if (!btn) return;

  // Log click + state without changing behavior
  console.log('[Observer]', btn.id, {
    trainingCompleted: window.state?.trainingCompleted,
    paymentLayer: window.state?.paymentLayer
  });

  // Optional visual feedback
  btn.style.outline = '2px solid #1abc9c';
  setTimeout(() => btn.style.outline = '', 300);
});
</script>

<!-- =========================
     MODULE BUTTON DISPATCHER + SAFE OBSERVER
========================= -->
<script>
document.addEventListener('DOMContentLoaded', () => {

  const tradingFloorBtn = document.getElementById('tradingFloorBtn');
  const traderLabBtn = document.getElementById('traderLabBtn');
  const cpilotBtn = document.getElementById('cpilotBtn');
  const paymentBtn = document.getElementById('paymentBtn');

  const actionMap = {
    tradingFloorBtn: 'TRADING_FLOOR',
    traderLabBtn: 'TRADER_LAB',
    cpilotBtn: 'CPILOT',
    paymentBtn: 'PAYMENT_GATE'
  };

  // ---------- SINGLE DISPATCHER ----------
  document.getElementById('home-mode').addEventListener('click', (e) => {
    const btn = e.target.closest('.module-btn');
    if (!btn) return;

    const action = actionMap[btn.id];
    if (!action) return;

    switch(action) {
      case 'TRADING_FLOOR':
        if (!state.trainingCompleted || state.paymentLayer !== 'LIVE') {
          alert('Complete training and payment to access Trading Floor.');
          return;
        }
        enterDashboard();
        break;

      case 'TRADER_LAB':
        if (!state.trainingCompleted) {
          alert('Complete training to access TraderLabâ„¢.');
          return;
        }
        window.location.href = 'traderlab.html';
        break;

      case 'CPILOT':
        window.location.href = 'cpilot.html';
        break;

      case 'PAYMENT_GATE':
        const method = prompt('Enter payment method (CARD/TRANSFER):', 'CARD');
        const amount = parseFloat(prompt('Enter amount in NGN:', '10000'));
        handlePaymentRequest(method, amount);
        updateActivationStatus();
        break;
    }
  });

  // ---------- SAFE TEST OBSERVER ----------
  document.getElementById('home-mode').addEventListener('click', (e) => {
    const btn = e.target.closest('.module-btn');
    if (!btn) return;

    // Console log + quick visual feedback
    console.log('[Observer]', btn.id, {
      trainingCompleted: state.trainingCompleted,
      paymentLayer: state.paymentLayer
    });
    btn.style.outline = '2px solid #1abc9c';
    setTimeout(() => btn.style.outline = '', 300);
  });

});
</script>
 
</body>
</html>
