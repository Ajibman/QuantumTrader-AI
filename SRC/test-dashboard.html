<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QT AI Test Dashboard</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { margin-top: 30px; }
    pre { background: #f5f5f5; padding: 10px; border-radius: 5px; max-height: 300px; overflow-y: auto; }
  </style>
</head>
<body>
  <h1>Quantum Trader AI - Test Dashboard</h1>

  <h2>Visitors</h2>
  <pre id="visitors">Waiting for data...</pre>

  <h2>Entry History</h2>
  <pre id="history">Waiting for data...</pre>

  <h2>Leaderboard</h2>
  <pre id="leaderboard">Waiting for data...</pre>

  <script>
    const socket = io("http://localhost:4000");

    const visitorsEl = document.getElementById("visitors");
    const historyEl = document.getElementById("history");
    const leaderboardEl = document.getElementById("leaderboard");

    // Initial data from server
    socket.on("initialData", (data) => {
      visitorsEl.textContent = JSON.stringify(data.visitors, null, 2);
      historyEl.textContent = JSON.stringify(data.entryHistory, null, 2);
      leaderboardEl.textContent = JSON.stringify(data.leaderboard, null, 2);
    });

    // Updates
    socket.on("visitorRouted", (visitor) => {
      visitorsEl.textContent = JSON.stringify({ ...JSON.parse(visitorsEl.textContent), [visitor.visitorId]: visitor }, null, 2);
    });

    socket.on("entryHistoryUpdate", ({ visitorId, entry }) => {
      const current = JSON.parse(historyEl.textContent);
      if (!current[visitorId]) current[visitorId] = [];
      current[visitorId].unshift(entry);
      historyEl.textContent = JSON.stringify(current, null, 2);
    });

    socket.on("leaderboardUpdate", (leaderboard) => {
      leaderboardEl.textContent = JSON.stringify(leaderboard, null, 2);
    });
  </script>
</body>
</html>
