 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>QuantumTrader AI — Trading Floor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="stylesheet" href="core/css/main.css"/>
<style>
:root{
  --qt-primary:#1f7f8c;
  --qt-primary-hover:#165f69;
  --qt-secondary:#0b3442;
  --qt-secondary-hover:#07262f;
  --qt-neutral:#e7f2f4;
  --qt-neutral-text:#102a33;
  --qt-locked-bg:#f1f4f6;
  --qt-locked-text:#9aa6ad;
}
body{margin:0;font-family:system-ui,sans-serif;background:#f7fbfc;color:#102a33;}
header{padding:1.5rem;background:var(--qt-secondary);color:#fff;text-align:center;}
main{padding:2rem;max-width:1100px;margin:auto;}
.section{margin-bottom:2rem;padding:1.5rem;background:#fff;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.05);}
.section h2{margin-top:0;color:var(--qt-secondary);}
button{padding:.8rem 1.2rem;font-size:1rem;border-radius:4px;border:none;cursor:pointer;margin:.5rem 0;width:100%;}
.btn-primary{background:var(--qt-primary);color:#fff;}
.btn-primary:hover{background:var(--qt-primary-hover);}
.btn-secondary{background:var(--qt-secondary);color:#fff;}
.btn-secondary:hover{background:var(--qt-secondary-hover);}
.btn-locked,button:disabled{background:var(--qt-locked-bg);color:var(--qt-locked-text);cursor:not-allowed;}
.panel{padding:1rem;background:var(--qt-neutral);border-radius:4px;max-height:250px;overflow-y:auto;}
.radio-group{margin:1rem 0;}
.radio-group label{display:block;margin-bottom:.5rem;cursor:pointer;}
#ori-ologo-container{position:fixed;bottom:20px;right:20px;width:110px;opacity:.85;z-index:999;}
#ori-ologo-container img{width:100%;border-radius:50%;}
</style>
</head>
<body>

<header>
<h1>Trading Floor</h1>
<p>Simulated Live Trading — Access Controlled</p>
</header>

<main>
<div id="ori-ologo-container">
  <img src="assets/images/qtai_ori_olokun.png" alt="Ori Ologo — Silent Guide"/>
</div>

<section class="section">
<h2>Trade Mode</h2>
<div class="radio-group">
  <label><input type="radio" name="trade-type" value="manual" checked> Manual Trade</label>
  <label><input type="radio" name="trade-type" value="autotrade"> Auto Trade</label>
</div>
</section>

<section class="section">
<h2>Auto Take-Profit Timing</h2>
<div class="radio-group">
  <label><input type="radio" name="tp-time" value="15s" checked> 15 Seconds</label>
  <label><input type="radio" name="tp-time" value="30s"> 30 Seconds</label>
  <label><input type="radio" name="tp-time" value="60s"> 1 Minute</label>
  <label><input type="radio" name="tp-time" value="120s"> 2 Minutes</label>
  <label><input type="radio" name="tp-time" value="180s"> 3 Minutes</label>
  <label><input type="radio" name="tp-time" value="240s"> 4 Minutes</label>
  <label><input type="radio" name="tp-time" value="300s"> 5 Minutes</label>
  <label><input type="radio" name="tp-time" value="600s"> 10 Minutes</label>
</div>
</section>

<section class="section">
<h2>Trading Controls</h2>
<button class="btn-primary" id="start-trade-btn" disabled>Start Auto Trading</button>
<button class="btn-secondary" id="stop-trade-btn" disabled>Stop Auto Trading</button>
</section>

<section class="section">
<h2>Simulation Monitor</h2>
<div class="panel" id="simulation-monitor">
  <p>Simulation logs will appear here once Auto Trading is activated.</p>
</div>
</section>
</main>

<script src="core/js/wallet.js"></script>
<script src="core/js/ori_ologo.js"></script>
<script src="core/js/tradingfloor_sim_bridge.js"></script>

<script type="module">
import { startTradingFloor, stopTradingFloor } from "./core/js/tradingfloor_run_controller.js";

document.getElementById("start-trade-btn").addEventListener("click", () => {
  try { startTradingFloor(); } 
  catch(e){ alert(e.message); }
});

document.getElementById("stop-trade-btn").addEventListener("click", () => {
  stopTradingFloor();
});
</script>

<section class="section" id="access-gate">
  <h2>Access Status</h2>
  <p id="access-message">Checking CPilot qualification...</p>
</section>

<section class="section">
<h2>Trade Mode</h2>
<div class="radio-group">
  <label><input type="radio" name="trade-type" value="manual" checked disabled> Manual Trade</label>
  <label><input type="radio" name="trade-type" value="autotrade" disabled> Auto Trade</label>
</div>
</section>

<section class="section">
<h2>Auto Take-Profit Timing</h2>
<div class="radio-group">
  <label><input type="radio" name="tp-time" value="15s" checked disabled> 15 Seconds</label>
  <label><input type="radio" name="tp-time" value="30s" disabled> 30 Seconds</label>
  <label><input type="radio" name="tp-time" value="60s" disabled> 1 Minute</label>
  <label><input type="radio" name="tp-time" value="120s" disabled> 2 Minutes</label>
  <label><input type="radio" name="tp-time" value="180s" disabled> 3 Minutes</label>
  <label><input type="radio" name="tp-time" value="240s" disabled> 4 Minutes</label>
  <label><input type="radio" name="tp-time" value="300s" disabled> 5 Minutes</label>
  <label><input type="radio" name="tp-time" value="600s" disabled> 10 Minutes</label>
</div>
</section>

<section class="section">
<h2>Trading Controls</h2>
<button class="btn-primary" id="start-trade-btn" disabled>Start Auto Trading</button>
<button class="btn-secondary" id="stop-trade-btn" disabled>Stop Auto Trading</button>
</section>

<script type="module">
import { startTradingFloor, stopTradingFloor } from "./core/js/tradingfloor_run_controller.js";

// Access gate check: must pass CPilot
const startBtn = document.getElementById("start-trade-btn");
const stopBtn = document.getElementById("stop-trade-btn");
const tpRadios = document.querySelectorAll('input[name="tp-time"]');
const modeRadios = document.querySelectorAll('input[name="trade-type"]');
const accessMsg = document.getElementById("access-message");

function unlockTradingFloor() {
  accessMsg.textContent = "Access Granted — Ready for Auto Trading.";
  startBtn.disabled = false;
  modeRadios.forEach(r => r.disabled = false);
  tpRadios.forEach(r => r.disabled = false);
}

// Simulated CPilot check
if (window.TraderLab && window.TraderLab.passedCPilot) {
  unlockTradingFloor();
} else {
  accessMsg.textContent = "⛔ Access Denied — Complete CPilot to unlock Trading Floor.";
}

startBtn.addEventListener("click", () => {
  try {
    startTradingFloor();
    startBtn.disabled = true;
    stopBtn.disabled = false;
    tpRadios.forEach(r => r.disabled = true);
    modeRadios.forEach(r => r.disabled = true);
  } catch(e){ alert(e.message); }
});

stopBtn.addEventListener("click", () => {
  stopTradingFloor();
  startBtn.disabled = false;
  stopBtn.disabled = true;
  tpRadios.forEach(r => r.disabled = false);
  modeRadios.forEach(r => r.disabled = false);
});
</script>

<section class="section">
  <h2>Trading Monitor</h2>
  <div class="panel" id="trading-monitor">
    <p>Simulation ticks will appear here once Auto Trading is activated.</p>
  </div>
</section>

<script type="module">
import { simulationFeed } from "./core/js/simulation/simulation_feed.js";

const monitor = document.getElementById("trading-monitor");
const startBtn = document.getElementById("start-trade-btn");
const stopBtn = document.getElementById("stop-trade-btn");

// Emit tick to monitor
function logTick(tick) {
  const p = document.createElement("p");
  p.textContent = `[${new Date(tick.timestamp).toLocaleTimeString()}] Price: ${tick.price} | Volume: ${tick.volume}`;
  monitor.prepend(p);
}

// Start TradingFloor simulation
export function startTradingFloor() {
  simulationFeed.subscribe(logTick);
  const selectedTP = document.querySelector('input[name="tp-time"]:checked').value;
  const durationMs = convertToMs(selectedTP);

  simulationFeed.start({ unit: "seconds", value: durationMs / 1000 });

  setTimeout(() => {
    stopTradingFloor();
  }, durationMs);
}

// Stop TradingFloor simulation
export function stopTradingFloor() {
  simulationFeed.stop();
}

// Convert radio button value to milliseconds
function convertToMs(value) {
  const num = parseInt(value, 10);
  if (value.endsWith("s")) return num * 1000;
  if (value.endsWith("m")) return num * 60000;
  return 10000; // default fallback
}
   </script>


 
</body>
</html>
