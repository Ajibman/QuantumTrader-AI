 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Activation — QuantumTrader AI™</title>

  <style>
    :root{
      --bg:#000428;
      --card:#071226;
      --muted:#bbb;
      --accent:#1abc9c;
      --wema-accent:#4B0082; /* dark purple */
      --danger:#e74c3c;
      --panel-gap:12px;
    }

    html,body{height:100%; margin:0; padding:0; background:var(--bg); color:#fff; font-family:Inter, Arial, sans-serif;}
    .container{max-width:880px; margin:0 auto; padding:18px;}

    header{display:flex; gap:16px; align-items:center; justify-content:center; margin-top:8px; flex-wrap:wrap;}
    header img{max-height:72px; width:auto;}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); border-radius:12px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,0.55);}

    h1{font-size:20px; margin:6px 0 8px;}
    p{margin:6px 0; color:var(--muted);}

    .center{text-align:center;}

    .row{display:flex; gap:12px; align-items:center;}
    .col{display:flex; flex-direction:column; gap:12px;}

    input[type="text"], input[type="password"], select {
      width:100%; padding:12px; border-radius:10px; border:none; outline:none; font-size:15px; background:#071226; color:#fff;
    }

    .btn {
      padding:12px 18px; border-radius:10px; border:none; font-weight:700; cursor:pointer;
    }
    .btn-primary { background:var(--accent); color:#061018; }
    .btn-ghost { background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.04); }

    .mode-pill { display:inline-block; padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:700; margin-right:8px;}
    .mode-active { box-shadow:0 6px 18px rgba(0,0,0,0.45); transform:translateY(-2px); }

    .payment-block { background:linear-gradient(180deg, rgba(75,0,130,0.12), rgba(75,0,130,0.06)); padding:14px; border-radius:10px; text-align:center; }
    .payment-block img { width:200px; max-width:60%; border-radius:10px; box-shadow:0 8px 20px rgba(75,0,130,0.36); }

    .muted{color:var(--muted); font-size:14px;}

    .help { font-size:13px; color:var(--muted); margin-top:8px; }

    footer { margin-top:18px; text-align:center; color:var(--muted); font-size:13px; }

    @media (max-width:520px){
      header img{max-height:56px;}
      .container{padding:12px;}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="images/qtai_globe.png" alt="QuantumTrader AI">
      <img src="images/peace_index_logo.png" alt="Peace Index Logo">
    </header>

    <section style="margin-top:20px;" aria-labelledby="actTitle">
      <div class="card">
        <div class="center">
          <h1 id="actTitle">Activation — Choose Mode</h1>
          <p class="muted">Select Simulation to test the system. Switch to Live only after you've verified payment.</p>
        </div>

        <div style="margin-top:14px;" class="col">
          <label for="actCode" style="font-size:14px;">Activation Code (token)</label>
          <input id="actCode" type="text" placeholder="Enter activation code (provided)">

          <div style="display:flex; gap:10px; align-items:center; margin-top:6px;">
            <div id="modeSimulation" class="mode-pill mode-active" data-mode="simulation" style="background:#072726;">SIMULATION</div>
            <div id="modeLive" class="mode-pill" data-mode="live" style="background:rgba(255,255,255,0.03);">LIVE (WEMA)</div>
            <div style="flex:1"></div>
            <button id="verifyBtn" class="btn btn-ghost" title="Verify activation code">Verify</button>
          </div>

          <!-- Payment block (visible when Live selected) -->
          <div id="livePayment" style="display:none; margin-top:14px;">
            <div class="payment-block">
              <div style="font-weight:700; margin-bottom:8px;">WEMA Bank — Scan to Pay</div>
              <img src="images/wema_qr.png" alt="WEMA QR Code" id="wemaQr">
              <div class="muted" style="margin-top:10px;">Pay NGN10,000 to: <strong>0299134895 — Olagoke Ajibulu</strong></div>
              <div style="margin-top:12px;">
                <button id="confirmPaymentBtn" class="btn btn-primary">I have paid — Verify Payment</button>
              </div>
              <div class="help">After successful verification your dashboard will unlock for live trading.</div>
            </div>
          </div>

          <!-- Simulation actions -->
          <div id="simulationActions" style="margin-top:14px;">
            <div style="display:flex; gap:10px; justify-content:center;">
              <button id="startSimBtn" class="btn btn-primary">Start Simulation</button>
              <button id="viewDocsBtn" class="btn btn-ghost">View Docs</button>
            </div>
            <div class="help">Simulation will use virtual funds and the same AI logic. No real money is used.</div>
          </div>

          <!-- Hidden admin area (toggle via long-press) -->
          <div id="adminArea" style="display:none; margin-top:14px;" class="card">
            <div style="font-weight:700; margin-bottom:8px;">Admin Controls</div>
            <label for="adminPass">Admin Password</label>
            <input id="adminPass" type="password" placeholder="Admin password">
            <div style="display:flex; gap:8px; margin-top:8px;">
              <button id="btnSwitchToLive" class="btn btn-primary">Force Live Mode (admin)</button>
              <button id="btnClearLocal" class="btn btn-ghost">Clear Local State</button>
            </div>
            <div class="help">Use admin only for switching environment or resetting test state.</div>
          </div>
        </div>
      </div>
    </section>

    <footer>© 2025 QuantumTrader-AI™ — For testing only</footer>
  </div>

<script>
  // Mode selection + activation logic
  const modeSimulation = document.getElementById('modeSimulation');
  const modeLive = document.getElementById('modeLive');
  const livePayment = document.getElementById('livePayment');
  const simulationActions = document.getElementById('simulationActions');
  const actCodeInput = document.getElementById('actCode');
  const startSimBtn = document.getElementById('startSimBtn');
  const confirmPaymentBtn = document.getElementById('confirmPaymentBtn');
  const verifyBtn = document.getElementById('verifyBtn');
  const adminArea = document.getElementById('adminArea');
  const viewDocsBtn = document.getElementById('viewDocsBtn');

  let currentMode = localStorage.getItem('qta_mode') || 'simulation';
  applyMode(currentMode);

  function applyMode(m){
    currentMode = m;
    localStorage.setItem('qta_mode', m);
    if (m === 'simulation') {
      modeSimulation.classList.add('mode-active');
      modeLive.classList.remove('mode-active');
      livePayment.style.display = 'none';
      simulationActions.style.display = 'block';
    } else {
      modeLive.classList.add('mode-active');
      modeSimulation.classList.remove('mode-active');
      livePayment.style.display = 'block';
      simulationActions.style.display = 'none';
    }
  }

  modeSimulation.addEventListener('click', () => applyMode('simulation'));
  modeLive.addEventListener('click', () => applyMode('live'));

  // Verify activation code (local validation placeholder)
  verifyBtn.addEventListener('click', () => {
    const code = actCodeInput.value.trim();
    if(!code){
      alert('Enter activation code.');
      return;
    }
    // Placeholder: call your backend to validate activation token
    // Example:
    // fetch('/api/validate-activation', { method:'POST', body: JSON.stringify({code}) })
    //   .then(...)
    // For now accept any non-empty code as valid for simulation.
    alert('Activation token accepted for testing.');
  });

  // Start Simulation: store flags and go to dashboard
  startSimBtn.addEventListener('click', () => {
    const code = actCodeInput.value.trim();
    if(!code){
      if(!confirm('No activation code entered. Start simulation anyway?')) return;
    }
    localStorage.setItem('qta_mode', 'simulation');
    localStorage.setItem('qta_activated', 'true');
    localStorage.setItem('qta_activation_token', code || '');
    // mark that this is a simulation session (dashboard will read this)
    location.href = 'dashboard.html';
  });

  // Confirm Payment (Live mode)
  confirmPaymentBtn.addEventListener('click', async () => {
    const code = actCodeInput.value.trim();
    if(!code){
      alert('Enter activation code before verifying payment.');
      return;
    }

    // This is a placeholder: call your server endpoint to verify WEMA payment
    // Example POST: /api/verify-wema-payment { token: code, amount: 10000 }
    // Server should respond { paid: true, amount:10000, txRef: '...' }
    confirmPaymentBtn.disabled = true;
    confirmPaymentBtn.textContent = 'Verifying...';

    try {
      // Replace this with real fetch to your backend
      // const resp = await fetch('/api/verify-wema-payment', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({token: code}) });
      // const data = await resp.json();
      // Simulated verification delay:
      await new Promise(r => setTimeout(r, 1200));
      // Simulated result:
      const data = { paid:true, amount:10000, txRef:'SIMULATED-REF-12345' };

      if (data && data.paid) {
        localStorage.setItem('qta_mode','live');
        localStorage.setItem('qta_activated','true');
        localStorage.setItem('qta_activation_token', code);
        localStorage.setItem('qta_payment_txref', data.txRef);
        alert('Payment verified. Proceeding to dashboard (Live mode).');
        location.href = 'dashboard.html';
      } else {
        alert('Payment not verified — please confirm payment in your WEMA app and try again.');
      }
    } catch (err) {
      console.error('verify payment error', err);
      alert('Payment verification failed — network or server error.');
    } finally {
      confirmPaymentBtn.disabled = false;
      confirmPaymentBtn.textContent = 'I have paid — Verify Payment';
    }
  });

  // Admin area: reveal on long press of header images (for safety)
  const header = document.querySelector('header');
  let pressTimer;
  header.addEventListener('mousedown', startPress);
  header.addEventListener('touchstart', startPress);
  header.addEventListener('mouseup', cancelPress);
  header.addEventListener('mouseleave', cancelPress);
  header.addEventListener('touchend', cancelPress);

  function startPress(e){
    pressTimer = setTimeout(() => {
      adminArea.style.display = 'block';
    }, 900); // long-press 900ms to reveal admin
  }
  function cancelPress(){
    clearTimeout(pressTimer);
  }

  // Admin quick actions
  document.getElementById('btnClearLocal').addEventListener('click', () => {
    if (!confirm('Clear local activation state?')) return;
    localStorage.removeItem('qta_mode');
    localStorage.removeItem('qta_activated');
    localStorage.removeItem('qta_activation_token');
    localStorage.removeItem('qta_payment_txref');
    alert('Local state cleared.');
    location.reload();
  });

  document.getElementById('btnSwitchToLive').addEventListener('click', () => {
    const pass = document.getElementById('adminPass').value;
    // Replace this check with a secure server-side check in production
    if(pass === 'letmeinAdmin!') {
      localStorage.setItem('qta_mode','live');
      alert('Admin forced Live mode. Proceed to dashboard.');
      location.href = 'dashboard.html';
    } else {
      alert('Invalid admin password.');
    }
  });

  viewDocsBtn.addEventListener('click', () => {
    // Link to docs or quick start guide — replace with your actual docs location
    window.open('docs/quickstart.html', '_blank', 'noopener');
  });
</script>
</body>
</html>
